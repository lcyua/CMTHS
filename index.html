<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>청소구역 배정</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; }
        .hidden { display: none; }
        table { width: 60%; margin: 20px auto; border-collapse: collapse; }
        th, td { border: 1px solid black; padding: 10px; }
        .login-container { margin-top: 20px; }
    </style>
</head>
<body>
    <h1 id="date"></h1>
    <p id="message"></p>
    <table id="schedule" class="hidden">
        <tr><th>학생명</th><th>청소구역</th></tr>
    </table>
    
    <div class="login-container">
        <button onclick="showLogin()">관리자 로그인</button>
        <div id="loginForm" class="hidden">
            <input type="password" id="password" placeholder="비밀번호 입력">
            <button onclick="checkPassword()">확인</button>
            <p id="loginMessage" style="color: red;"></p>
        </div>
    </div>
    
    <div id="adminPanel" class="hidden">
        <h2>청소구역 수정</h2>
        <textarea id="adminData" rows="6" cols="50"></textarea><br>
        <button onclick="saveData()">저장</button>
    </div>

    <script>
        const students = ["박찬진", "이동현", "정지훈", "정한영", "하현일", "허윤재"];
        const areas = [
            "빗자루, 대걸래, 분리수거", "빗자루, 대걸래, 분리수거", 
            "환기, 빗자루, 대걸래", "손걸래, 세절기", 
            "손걸래, 세절기", "교사쓰레기통, 전체 쓰레기통 정리"
        ];
        const validDays = [1, 3, 5];
        const password = "1214";
        const storageKey = "cleaningSchedule";
        
        function getKSTDate() {
            const now = new Date();
            return new Date(now.getTime() + (now.getTimezoneOffset() + 540) * 60000);
        }
        
        function updateSchedule() {
            const today = getKSTDate();
            const day = today.getDay();
            document.getElementById("date").innerText = `${today.toLocaleDateString()} (${"일월화수목금토"[day]})`;
            
            if (!validDays.includes(day)) {
                document.getElementById("message").innerText = "오늘은 봉사요일이 아닙니다.";
                return;
            }
            
            document.getElementById("message").innerText = "오늘의 청소구역 배정";
            document.getElementById("schedule").classList.remove("hidden");
            
            let scheduleData = JSON.parse(localStorage.getItem(storageKey)) || students.map((s, i) => ({ student: s, area: areas[i] }));
            
            let table = document.getElementById("schedule");
            table.innerHTML = "<tr><th>학생명</th><th>청소구역</th></tr>" + scheduleData.map(entry => `<tr><td>${entry.student}</td><td>${entry.area}</td></tr>`).join("");
        }
        
        function showLogin() {
            document.getElementById("loginForm").classList.toggle("hidden");
        }
        
        function checkPassword() {
            const input = document.getElementById("password").value;
            if (input === password) {
                document.getElementById("loginMessage").innerText = "";
                document.getElementById("adminPanel").classList.remove("hidden");
                document.getElementById("adminData").value = JSON.stringify(JSON.parse(localStorage.getItem(storageKey)) || students.map((s, i) => ({ student: s, area: areas[i] })), null, 2);
            } else {
                document.getElementById("loginMessage").innerText = "잘못된 비밀번호입니다.";
            }
        }
        
        function saveData() {
            try {
                const newData = JSON.parse(document.getElementById("adminData").value);
                localStorage.setItem(storageKey, JSON.stringify(newData));
                alert("저장되었습니다.");
                updateSchedule();
            } catch (error) {
                alert("잘못된 형식입니다.");
            }
        }
        
        updateSchedule();
    </script>
</body>
</html>
