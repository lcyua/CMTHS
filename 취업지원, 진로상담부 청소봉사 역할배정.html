<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>청소구역 배정 프로그램</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .container { max-width: 800px; margin: auto; }
        .date { font-size: 24px; margin-bottom: 20px; }
        table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #f2f2f2; }
        .admin-login { cursor: pointer; color: blue; text-decoration: underline; }
        .admin-panel { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 20px; border: 1px solid #ccc; box-shadow: 0 0 10px rgba(0,0,0,0.3); }
        .admin-panel input, .admin-panel button { margin: 5px 0; }
        .edit-section { margin-top: 10px; }
        .edit-section input { width: 100%; box-sizing: border-box; margin: 5px 0; }
    </style>
</head>
<body>
    <div class="container">
        <div class="date" id="todayDate"></div>
        <div id="schedule"></div>
        <p class="admin-login" onclick="showAdminLogin()">관리자 로그인</p>
    </div>

    <div class="admin-panel" id="adminPanel">
        <h3>관리자 설정</h3>
        <input type="password" id="adminPassword" placeholder="비밀번호 입력">
        <button onclick="checkPassword()">확인</button>
        <div id="adminEdit" style="display: none;">
            <h4>청소구역 및 학생명 변경</h4>
            <div class="edit-section">
                <h5>청소구역</h5>
                <input type="text" id="area1" placeholder="1. 청소구역">
                <input type="text" id="area2" placeholder="2. 청소구역">
                <input type="text" id="area3" placeholder="3. 청소구역">
                <input type="text" id="area4" placeholder="4. 청소구역">
                <input type="text" id="area5" placeholder="5. 청소구역">
                <input type="text" id="area6" placeholder="6. 청소구역">
            </div>
            <div class="edit-section">
                <h5>학생명</h5>
                <input type="text" id="student1" placeholder="1. 학생명">
                <input type="text" id="student2" placeholder="2. 학생명">
                <input type="text" id="student3" placeholder="3. 학생명">
                <input type="text" id="student4" placeholder="4. 학생명">
                <input type="text" id="student5" placeholder="5. 학생명">
                <input type="text" id="student6" placeholder="6. 학생명">
            </div>
            <button onclick="saveChanges()">저장</button>
            <button onclick="closeAdmin()">닫기</button>
        </div>
    </div>

    <script>
        const students = ["박찬진", "이동현", "정지훈", "정한영", "하현일", "허윤재"];
        let areas = [
            "빗자루, 대걸레, 분리수거",
            "빗자루, 대걸레, 분리수거",
            "환기, 빗자루, 대걸레",
            "손걸레, 세절기",
            "손걸레, 세절기",
            "교사쓰레기통, 전체 쓰레기통 정리"
        ];

        const weekdays = ["일요일", "월요일", "화요일", "수요일", "목요일", "금요일", "토요일"];
        const today = new Date("2025-03-28T00:00:00+09:00"); // KST 기준 2025-03-28 (금요일)
        const dayOfWeek = today.getDay();
        const dateStr = `${today.getFullYear()}년 ${today.getMonth() + 1}월 ${today.getDate()}일 ${weekdays[dayOfWeek]}`;

        document.getElementById("todayDate").textContent = dateStr;

        function displaySchedule() {
            const scheduleDiv = document.getElementById("schedule");
            const isTodayException = (today.getFullYear() === 2025 && today.getMonth() === 2 && today.getDate() === 28); // 3월 28일 예외
            if (dayOfWeek >= 1 && dayOfWeek <= 3 || isTodayException) { // 월, 화, 수 + 오늘(금요일) 예외
                const assignments = assignCleaningAreas();
                let table = "<h2>오늘의 청소구역 배정표 (오전 8시)</h2><table><tr><th>학생명</th><th>청소구역</th></tr>";
                assignments.forEach(([student, area]) => {
                    table += `<tr><td>${student}</td><td>${area}</td></tr>`;
                });
                table += "</table>";
                scheduleDiv.innerHTML = table;
            } else {
                scheduleDiv.innerHTML = "<p>오늘은 봉사요일이 아닙니다.</p>";
            }
        }

        function assignCleaningAreas() {
            const shuffledStudents = [...students].sort(() => Math.random() - 0.5);
            return shuffledStudents.map((student, index) => [student, areas[index]]);
        }

        function showAdminLogin() {
            document.getElementById("adminPanel").style.display = "block";
        }

        function checkPassword() {
            const password = document.getElementById("adminPassword").value;
            if (password === "1214") {
                document.getElementById("adminPassword").style.display = "none";
                document.querySelector("button[onclick='checkPassword()']").style.display = "none";
                document.getElementById("adminEdit").style.display = "block";
                for (let i = 0; i < 6; i++) {
                    document.getElementById(`area${i + 1}`).value = areas[i];
                    document.getElementById(`student${i + 1}`).value = students[i];
                }
            } else {
                alert("잘못된 비밀번호");
            }
        }

        function saveChanges() {
            const newAreas = [];
            const newStudents = [];
            for (let i = 1; i <= 6; i++) {
                const area = document.getElementById(`area${i}`).value.trim();
                const student = document.getElementById(`student${i}`).value.trim();
                if (!area || !student) {
                    alert("모든 칸을 채워주세요.");
                    return;
                }
                newAreas.push(area);
                newStudents.push(student);
            }
            areas = newAreas;
            students.splice(0, students.length, ...newStudents);
            alert("변경 사항이 저장되었습니다.");
            closeAdmin();
            displaySchedule();
        }

        function closeAdmin() {
            document.getElementById("adminPanel").style.display = "none";
            document.getElementById("adminPassword").value = "";
            document.getElementById("adminEdit").style.display = "none";
            document.getElementById("adminPassword").style.display = "block";
            document.querySelector("button[onclick='checkPassword()']").style.display = "block";
        }

        displaySchedule();
    </script>
</body>
</html>